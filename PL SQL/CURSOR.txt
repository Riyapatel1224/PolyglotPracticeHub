-- DECLARE A CURSOR WHICH WILL DISPLAY SRNO. , LAST_NAME , JOB_ID , HIRE_DATE AND SALARY OF ALL EMPLOYEES.
-- DISPLAY RESULT WITH PROPER COLUMN HEADINGS AND LINES AS SEPARATOR.

DECLARE 
	V_LN EMPLOYEES.LAST_NAME%TYPE;
	V_JI EMPLOYEES.JOB_ID%TYPE;
	V_HD EMPLOYEES.HIRE_DATE%TYPE;
	V_SAL EMPLOYEES.SALARY%TYPE;

	CURSOR EMP_CURSOR IS
        SELECT LAST_NAME, JOB_ID, HIRE_DATE, SALARY FROM EMPLOYEES;
BEGIN 
	OPEN EMP_CURSOR;
	DBMS_OUTPUT.PUT_LINE(RPAD ('=',60, '='));
	DBMS_OUTPUT.PUT_LINE(LPAD('SRNO',4) || '   ' || RPAD('LAST_NAME',10) || '   ' || LPAD('SALARY',13) ||'   '|| RPAD('JOB_ID',10)||'   '||RPAD('HIRE_DATE',10));
	DBMS_OUTPUT.PUT_LINE(RPAD ('=',60, '='));
		LOOP
			FETCH EMP_CURSOR INTO V_LN, V_JI, V_HD, V_SAL ;
				EXIT WHEN EMP_CURSOR%NOTFOUND;
					DBMS_OUTPUT.PUT_LINE(LPAD(EMP_CURSOR%ROWCOUNT,4) || '   ' || RPAD(INITCAP(V_LN),10) ||'   '|| LPAD(V_SAL,13) ||'   '||  RPAD(V_JI,10)||'   '||RPAD(V_HD,10));
		END LOOP;
	DBMS_OUTPUT.PUT_LINE(RPAD ('=',60, '='));
	CLOSE EMP_CURSOR;
END;
/


-- DECLARE A CURSOR WHICH WILL DISPLAY SRNO. , DEPARTMENT_NAME , CITY , COUNTRY_NAME.
-- DISPLAY RESULT WITH PROPER COLUMN HEADINGS AND LINES AS SEPARATOR.
-- EDLCR
DECLARE 
	V_DN DEPARTMENTS.DEPARTMENT_NAME%TYPE;
	V_CITY LOCATIONS.CITY%TYPE;
	V_COUNTRYNAME COUNTRIES.COUNTRY_NAME%TYPE;

	CURSOR EMP_CURSOR IS 
		SELECT DEPARTMENT_NAME, CITY, COUNTRY_NAME FROM DEPARTMENTS
        INNER JOIN LOCATIONS USING(LOCATION_ID) 
		INNER JOIN COUNTRIES USING(COUNTRY_ID);

BEGIN 
		OPEN EMP_CURSOR;
		DBMS_OUTPUT.PUT_LINE(RPAD('=',60,'='));
		DBMS_OUTPUT.PUT_LINE(LPAD('SRNO',4)||'   '|| RPAD('DEPARTMENT_NAME',10) ||'   '|| RPAD('CITY',20)||'   '|| RPAD('COUNTRY_NAME',12));
		DBMS_OUTPUT.PUT_LINE(RPAD('=',60,'='));

			LOOP
				FETCH EMP_CURSOR INTO V_DN , V_CITY, V_COUNTRYNAME;
					EXIT WHEN EMP_CURSOR%NOTFOUND;
						DBMS_OUTPUT.PUT_LINE(LPAD(EMP_CURSOR%ROWCOUNT,4)||'   '|| RPAD(V_DN,10) ||'   '|| RPAD(V_CITY,20)||'   '|| RPAD(V_COUNTRYNAME,12));
			END LOOP;
		DBMS_OUTPUT.PUT_LINE(RPAD('=',60,'='));
	CLOSE EMP_CURSOR;
END;
/




-- DECLARE A CURSOR WHICH WILL HOLD DATA OF EMPLOYEES WHO WORKS IN DEPARMENT 90
-- IT SHOULD HOLD FIRST_NAME , JOB_ID, HIRE_DATE, SALARY VALUES.
-- IT SHOULD DISPLAY FIRST_NAME, JOB_ID, HIRE_DATE, SALARY, YEARLY_SALARY AT THE END IT SHOULD ALSO DISPLAY SUM OF SALARY COLUMN AND SUM OF YEARLY_ SALARY -- COLUMN.
-- (DON'T USE SUMMARY FUNCTION)


-- DECLARE A CURSOR WHICH WILL HOLD DATA OF EMPLOYEES WHO WORKS IN DEPARMENT 90
-- IT SHOULD HOLD FIRST_NAME , JOB_ID, HIRE_DATE, SALARY VALUES.
-- IT SHOULD DISPLAY FIRST_NAME, JOB_ID, HIRE_DATE, SALARY, YEARLY_SALARY AT THE END 
-- IT SHOULD ALSO DISPLAY SUM OF SALARY COLUMN AND SUM OF YEARLY_ SALARY COLUMN.
-- (DON'T USE SUMMARY FUNCTION)


DECLARE 
	V_FN EMPLOYEES.FIRST_NAME%TYPE;
	V_JI EMPLOYEES.JOB_ID%TYPE;
	V_HD EMPLOYEES.HIRE_DATE%TYPE;
	V_SAL EMPLOYEES.SALARY%TYPE;
	V_TOTALYSAL NUMBER := 0;
	V_TOTALSAL NUMBER := 0;

	CURSOR EMP_CURSOR IS 
		SELECT FIRST_NAME, JOB_ID, HIRE_DATE, SALARY FROM EMPLOYEES WHERE DEPARTMENT_ID = 90;
BEGIN 
	OPEN EMP_CURSOR;
	DBMS_OUTPUT.PUT_LINE(RPAD('-',60,'-'));
	DBMS_OUTPUT.PUT_LINE(RPAD('FIRST_NAME',10)||'   '|| RPAD('JOB_ID',8) ||'   '|| LPAD('HIRE_DATE',10)||'   '|| LPAD('SALARY',8) ||'   '|| LPAD('YEARLY SALARY',10));
	DBMS_OUTPUT.PUT_LINE(RPAD('-',60,'-'));

	LOOP
		FETCH EMP_CURSOR INTO V_FN, V_JI, V_HD, V_SAL;
			EXIT WHEN EMP_CURSOR%NOTFOUND;
				DBMS_OUTPUT.PUT_LINE(RPAD(V_FN,10)||'   '|| RPAD(V_JI,8) ||'   '|| LPAD(V_HD,10)||'   '|| LPAD(V_SAL,8) ||'   '|| LPAD(V_SAL*12,10));
				V_TOTALYSAL := V_TOTALYSAL + (V_SAL*12);
				V_TOTALSAL := V_TOTALSAL + V_SAL;
	END LOOP;
	DBMS_OUTPUT.PUT_LINE(RPAD('-',60,'-'));
	DBMS_OUTPUT.PUT_LINE(RPAD('TOTAL SALARY',40) || RPAD(V_TOTALSAL,8) ||LPAD(V_TOTALYSAL,10));
	DBMS_OUTPUT.PUT_LINE(RPAD('-',60,'-'));
	CLOSE EMP_CURSOR;
END;
/
