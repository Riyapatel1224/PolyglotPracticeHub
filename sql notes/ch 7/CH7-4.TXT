SQL> 
SQL> REM DISPLAY DEPARTMENT_ID WISE AVERGE SALARY PAID
SQL> 
SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
------------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                     7000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
           90  19333.3333                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
           20        9500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
          110       10150                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
           50        3500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
           80  10033.3333                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
           60        6400                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
           10        4400                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           

8 rows selected.

SQL> REM DISPLAY DEPARTMENT_ID AND AVERGE SALARY FOR THE DEPARTMENT TO WHICH HIGHEST AVERAGE SALARY IS PAID.
SQL> 
SQL> REM AVG(SALARY) = MAX(AVG(SALARY))
SQL> 
SQL> REM SUMMARY ITEM = NESTED SUMMARY ITEM
SQL> 
SQL> REM 'HAVING' DO NOT SUPPORT NESTED SUMMARY ITEM.
SQL> 
SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING AVG(SALARY) = MAX(AVG(SALARY));
SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING AVG(SALARY) = MAX(AVG(SALARY))
                                                                                                  *
ERROR at line 1:
ORA-00935: group function is nested too deeply 


SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING AVG(SALARY) =
  2  (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES);
(SELECT MAX(AVG(SALARY)) FROM EMPLOYEES)
            *
ERROR at line 2:
ORA-00978: nested group function without GROUP BY 


SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING AVG(SALARY) =
  2  (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
------------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
           90  19333.3333                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           

SQL> REM SUB QUERY CAN BE USED TO COMPARE NESTED SUMMARY ITEM IN 'HAVING' CLAUSE.
SQL> 
SQL> REM DISPLAY JOB_ID AND TOTAL SALARY PAID FOR THE JOB TO WHICH LOWEST TOTAL SALARY IS PAID.
SQL> 
SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING SUM(SALARY) = (SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID);

JOB_ID     SUM(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
---------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
AD_ASST           4400                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> REM 1 DISPLAY MANAGER_ID WISE , AVERAGE SALARY FOR THE MANAGER TO WHICH LOWEST AVERAGE SALARY IS PAID.
SQL> 
SQL> REM 2 DISPLAY JOB_ID WISE , TOTAL SALARY FOR THE JOB TO WHICH HIGHEST TOTAL SALARY IS PAID.
SQL> 
SQL> REM 3 DISPLAY DEPARTMENT_ID WISE , COUNT OF EMPLOYEES FOR THE DEPARTMENT FOR WHICH LOWEST NUMBER OF EMPLOYEES ARE EMPLOYED
SQL> 
SQL> REM 4 DISPLAY MANAGER_ID WISE HIGHEST SALARY FOR THE MANAGER TO WHICH MINIMUM HIGHEST SALARY IS PAID
SQL> 
SQL> REM 5 DISPLAY JOB_ID WISE , LOWEST SALARY FOR ALL THE JOBS EXCEPT TO WHICH MAXIMUM LOWEST SALARY IS PAID.
SQL> 
SQL> 
SQL> 
SQL> 
SQL> REM 1 DISPLAY MANAGER_ID WISE , AVERAGE SALARY FOR THE MANAGER TO WHICH LOWEST AVERAGE SALARY IS PAID.
SQL> 
SQL> SELECT MANAGER_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY MANAGER_ID
  4  HAVING AVG(SALARY) = (SELECT MIN(AVG(SALARY)) FROM EMPLOYEES GROUP BY MANAGER_ID);

MANAGER_ID AVG(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
---------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       124        2925                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> REM 2 DISPLAY JOB_ID WISE , TOTAL SALARY FOR THE JOB TO WHICH HIGHEST TOTAL SALARY IS PAID.
SQL> 
SQL> SELECT JOB_ID , SUM(SALARY)
  2   FROM EMPLOYEES
  3   GROUP BY JOB_ID
  4   HAVING SUM(SALARY) = (SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID);

JOB_ID     SUM(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
---------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
AD_VP            34000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> REM 3 DISPLAY DEPARTMENT_ID WISE , COUNT OF EMPLOYEES FOR THE DEPARTMENT FOR WHICH LOWEST NUMBER OF EMPLOYEES ARE EMPLOYED
SQL> 
SQL> SELECT DEPARTMENT_ID , COUNT(*)
  2  FROM EMPLOYEES
  3  GROUP BY DEPARTMENT_ID
  4  HAVING COUNT(*) = (SELECT MIN(COUNT(*)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

DEPARTMENT_ID   COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                       1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
           10          1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

SQL> REM 4 DISPLAY MANAGER_ID WISE HIGHEST SALARY FOR THE MANAGER TO WHICH MINIMUM HIGHEST SALARY IS PAID
SQL> 
SQL> SELECT MANAGER_ID , MAX(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY MANAGER_ID
  4  HAVING MAX(SALARY) = (SELECT MIN(MAX(SALARY)) FROM EMPLOYEES GROUP BY MANAGER_ID);

MANAGER_ID MAX(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
---------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       124        3500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> REM 5 DISPLAY JOB_ID WISE , LOWEST SALARY FOR ALL THE JOBS EXCEPT TO WHICH MAXIMUM LOWEST SALARY IS PAID.
SQL> 
SQL> SELECT JOB_ID , MIN(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING MIN(SALARY) = (SELECT MAX(MIN(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID);

JOB_ID     MIN(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
---------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
AD_PRES          24000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> SELECT JOB_ID , MIN(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING MIN(SALARY) != (SELECT MAX(MIN(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID);

JOB_ID     MIN(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
---------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
IT_PROG           4200                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
AC_MGR           12000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
AC_ACCOUNT        8300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
ST_MAN            5800                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
AD_ASST           4400                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
AD_VP            17000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
SA_MAN           10500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
MK_MAN           13000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
SA_REP            7000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
MK_REP            6000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
ST_CLERK          2500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

11 rows selected.

SQL> REM 1 DISPLAY DEPARTMENT_ID , AVERAGE SALARY FOR THE DEPARTMENTS TO WHICH EITHER LOWEST OR HIGHEST AVERAGE SALARY IS PAID.
SQL> 
SQL> REM 2 DISPLAY HIRE YEAR WISE , TOTAL SALARY FOR ALL EXCEPT HIRE YEARS TO WHICH EITHER LOWEST OR HIGHEST TOTAL SALARY IS PAID.
SQL> 
SQL> REM 3 DISPLAY HIRE QUARTER WISE , COUNT OF EMPLOYEES FOR THE HIRE QUARTERS FOR WHICH EITHER LOWEST OR HIGHEST NUMBER OF EMPLOYEED WERE HIRED.
SQL> 
SQL> 
SQL> 
SQL> REM 1 DISPLAY DEPARTMENT_ID , AVERAGE SALARY FOR THE DEPARTMENTS TO WHICH EITHER LOWEST OR HIGHEST AVERAGE SALARY IS PAID.
SQL> 
SQL> SELECT DEPARTMENT_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY DEPARTMENT_ID
  4  HAVING AVG(SALARY) IN ((SELECT MIN(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID),
  5                         (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID));

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
------------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
           90  19333.3333                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
           50        3500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           

SQL> REM 2 DISPLAY HIRE YEAR WISE , TOTAL SALARY FOR ALL EXCEPT HIRE YEARS TO WHICH EITHER LOWEST OR HIGHEST TOTAL SALARY IS PAID.
SQL> 
SQL> SELECT TO_CHAR(HIRE_DATE,'RRRR') YEAR , SUM(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY TO_CHAR(HIRE_DATE, 'RRRR')
  4  HAVING SUM(SALARY) NOT IN ((SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR')),
  5                             (SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR')));

YEAR SUM(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
---- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1997        9100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
2000       10500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1994       20300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1991        6000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1990        9000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1989       17000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1993       17000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1999       17000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1996       24000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1998       13700                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

10 rows selected.

SQL> SELECT TO_CHAR(HIRE_DATE,'RRRR') YEAR , SUM(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY TO_CHAR(HIRE_DATE, 'RRRR')
  4  HAVING SUM(SALARY) <> (SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR'))
  5  AND    SUM(SALARY) <> (SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR'));

YEAR SUM(SALARY)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
---- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1997        9100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
2000       10500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1994       20300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1991        6000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1990        9000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1989       17000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1993       17000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1999       17000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1996       24000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
1998       13700                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

10 rows selected.

SQL> REM 3 DISPLAY HIRE QUARTER WISE , COUNT OF EMPLOYEES FOR THE HIRE QUARTERS FOR WHICH EITHER LOWEST OR HIGHEST NUMBER OF EMPLOYEED WERE HIRED.
SQL> 
SQL> SELECT TO_CHAR(HIRE_DATE,'Q') , COUNT(*)
  2  FROM EMPLOYEES
  3  GROUP BY TO_CHAR(HIRE_DATE,'Q')
  4  HAVING COUNT(*) = (SELECT MIN(COUNT(*)) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'Q'))
  5  OR     COUNT(*) = (SELECT MAX(COUNT(*)) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'Q'));

T   COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
1          8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
4          2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

SQL> SELECT TO_CHAR(HIRE_DATE,'Q') , COUNT(*)
  2  FROM EMPLOYEES
  3  GROUP BY TO_CHAR(HIRE_DATE,'Q')
  4  HAVING COUNT(*) IN ((SELECT MIN(COUNT(*)) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'Q')),
  5                      (SELECT MAX(COUNT(*)) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'Q')));

T   COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
1          8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
4          2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

SQL> 
SQL> 
SQL> SELECT E.FIRST_nAME , E.SALARY , EJ.GRADE_LEVEL , M.FIRST_NAME , M.SALARY , MJ.GRADE_LEVEL
  2   FROM EMPLOYEES E
  3   JOIN EMPLOYEES M ON E.MANAGER_ID = M.EMPLOYEE_ID
  4   JOIN JOB_GRADES EJ ON E.SALARY BETWEEN LOWEST_SAL AND HIGHEST_SAL
  5   JOIN JOB_GRADES MJ ON M.SALARY >= MJ.LOWEST_SAL AND M.SALARY <= MJ.HIGHEST_SAL;

FIRST_NAME          SALARY GRA FIRST_NAME          SALARY GRA                                                                                                                                                                                                                                                                                                                                                                                                                                                       
--------------- ---------- --- --------------- ---------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Neena                17000 E   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Lex                  17000 E   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Eleni                10500 D   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Michael              13000 D   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Kevin                 5800 B   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Jennifer              4400 B   Neena                17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Shelley              12000 D   Neena                17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Alexander             9000 C   Lex                  17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Pat                   6000 C   Michael              13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
William               8300 C   Shelley              12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Jonathon              8600 C   Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Ellen                11000 D   Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Kimerely              7000 C   Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Diana                 4200 B   Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Bruce                 6000 C   Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Peter                 2500 A   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Trenna                3500 B   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Curtis                3100 B   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Randall               2600 A   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         

19 rows selected.

SQL> SELECT E.FIRST_nAME , E.SALARY , EJ.GRADE_LEVEL , M.FIRST_NAME , M.SALARY , MJ.GRADE_LEVEL
  2   FROM EMPLOYEES E
  3   JOIN EMPLOYEES M ON E.MANAGER_ID = M.EMPLOYEE_ID
  4   JOIN JOB_GRADES EJ ON E.SALARY BETWEEN LOWEST_SAL AND HIGHEST_SAL
  5   JOIN JOB_GRADES MJ ON M.SALARY >= MJ.LOWEST_SAL AND M.SALARY <= HIGHEST_SAL;
 JOIN JOB_GRADES MJ ON M.SALARY >= MJ.LOWEST_SAL AND M.SALARY <= HIGHEST_SAL
                                                                 *
ERROR at line 5:
ORA-00918: column ambiguously defined 


SQL> SELECT E.FIRST_nAME , E.SALARY , EJ.GRADE_LEVEL , M.FIRST_NAME , M.SALARY , MJ.GRADE_LEVEL
  2   FROM EMPLOYEES E
  3   JOIN EMPLOYEES M ON E.MANAGER_ID = M.EMPLOYEE_ID
  4    JOIN JOB_GRADES MJ ON M.SALARY >= LOWEST_SAL AND M.SALARY <= HIGHEST_SAL
  5    JOIN JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL;

FIRST_NAME          SALARY GRA FIRST_NAME          SALARY GRA                                                                                                                                                                                                                                                                                                                                                                                                                                                       
--------------- ---------- --- --------------- ---------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Neena                17000 E   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Lex                  17000 E   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Michael              13000 D   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Shelley              12000 D   Neena                17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Ellen                11000 D   Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Eleni                10500 D   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Alexander             9000 C   Lex                  17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Jonathon              8600 C   Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
William               8300 C   Shelley              12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Kimerely              7000 C   Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Bruce                 6000 C   Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Pat                   6000 C   Michael              13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Kevin                 5800 B   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Jennifer              4400 B   Neena                17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Diana                 4200 B   Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Trenna                3500 B   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Curtis                3100 B   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Randall               2600 A   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Peter                 2500 A   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         

19 rows selected.

SQL> SELECT E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL,
  2         M.FIRST_NAME MGR_NAME , M.SALARY MGR_SALARY , MJ.GRADE_LEVEL MGR_GRADE_LEVEL
  3  FROM   EMPLOYEES E
  4  JOIN   EMPLOYEES M ON E.MANAGER_ID = M.EMPLOYEE_ID
  5  JOIN   JOB_GRADES ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL
  6  JOIN   JOB_GRADES ON M.SALARY BETWEEN MJ.LOWEST_SAL AND MJ.HIGHEST_SAL
  7  AND EJ.GRADE_LEVEL = MJ.GRADE_LEVEL
  8  
SQL> 
SQL> SELECT E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL,
  2         M.FIRST_NAME MGR_NAME , M.SALARY MGR_SALARY , MJ.GRADE_LEVEL MGR_GRADE_LEVEL
  3  FROM   EMPLOYEES E
  4  JOIN   EMPLOYEES M ON E.MANAGER_ID = M.EMPLOYEE_ID
  5  JOIN   JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL
  6  JOIN   JOB_GRADES MJ ON M.SALARY BETWEEN MJ.LOWEST_SAL AND MJ.HIGHEST_SAL
  7  AND EJ.GRADE_LEVEL = MJ.GRADE_LEVEL;

EMP_NAME        EMP_SALARY EMP MGR_NAME        MGR_SALARY MGR                                                                                                                                                                                                                                                                                                                                                                                                                                                       
--------------- ---------- --- --------------- ---------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Neena                17000 E   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Lex                  17000 E   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Bruce                 6000 C   Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Curtis                3100 B   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Trenna                3500 B   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Ellen                11000 D   Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         

6 rows selected.

SQL> SELECT * FROM JOB_GRADES;

GRA LOWEST_SAL HIGHEST_SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
--- ---------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
A         1000        2999                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
B         3000        5999                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
C         6000        9999                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
D        10000       14999                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
E        15000       24999                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
F        25000       40000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          

6 rows selected.

SQL> REM DISPLAY FIRST_NAME , SALARY , GRADE_LEVEL FOR EMPLOYEE AND COLLEGUE. CONSIDER COLLEGUE WHO GETS SALARY IN THE SAME GRADE_LEVEL.
SQL> 
SQL> SELECT E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL,
  2         C.FIRST_NAME COLL_NAME , C.SALARY COLL_SALARY , CJ.GRADE_LEVEL COLL_GRADE_LEVEL
  3  FROM   EMPLOYEES E
  4  JOIN   EMPLOYEES C
  5  
SQL> 
SQL> 
SQL> 
SQL> SELECT E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL
  2  FROM EMPLOYEES E
  3  JOIN JOB_GRADES EJ ON SALARY BETWEEN E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL;
JOIN JOB_GRADES EJ ON SALARY BETWEEN E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL
                                              *
ERROR at line 3:
ORA-00905: missing keyword 


SQL> SELECT E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL
  2  FROM EMPLOYEES E
  3  JOIN JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL;

EMP_NAME        EMP_SALARY EMP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- ---------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
Peter                 2500 A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Randall               2600 A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Curtis                3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Trenna                3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jennifer              4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Pat                   6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kimerely              7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
William               8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Ellen                11000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Shelley              12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Michael              13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Neena                17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Lex                  17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

20 rows selected.

SQL> SELECT C.FIRST_NAME COLL_NAME , C.SALARY COLL_SALARY , CJ.GRADE_LEVEL COLL_GRADE_LEVEL
  2  FROM EMPLOYEES C
  3  JOIN JOB_GRADES CJ ON C.SALARY BETWEEN CJ.LOWEST_SAL AND CJ.HIGHEST_SAL;

COLL_NAME       COLL_SALARY COL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
--------------- ----------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
Peter                  2500 A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Randall                2600 A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Trenna                 3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Diana                  4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Kevin                  5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Bruce                  6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Alexander              9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Eleni                 10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Ellen                 11000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Michael               13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Neena                 17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Lex                   17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Steven                24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       

20 rows selected.

SQL> SELECT EMP_NAME , EMP_SALARY , EMP_GRADE_LEVEL ,
  2         COLL_NAME , COLL_SALARY , COLL_GRADE_LEVEL
  3  FROM
  4  (SELECT E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL
  5  FROM EMPLOYEES E
  6  JOIN JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL)
  7  E JOIN
  8  (SELECT E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL
  9  FROM EMPLOYEES E
 10  JOIN JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL) C
 11  ON EMP_GRADE_LEVEL = COLL_GRADE_LEVEL
 12  
SQL> 
SQL> 
SQL> SELECT EMP_NAME , EMP_SALARY , EMP_GRADE_LEVEL ,
  2         COLL_NAME , COLL_SALARY , COLL_GRADE_LEVEL
  3  FROM (SELECT E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL
  4  FROM EMPLOYEES E
  5  JOIN JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL)
  6  JOIN
  7  (SELECT E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL
  8  FROM EMPLOYEES E
  9  JOIN JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL) C
 10  ON EMP_GRADE_LEVEL = COLL_GRADE_LEVEL;
ON EMP_GRADE_LEVEL = COLL_GRADE_LEVEL
                     *
ERROR at line 10:
ORA-00904: "COLL_GRADE_LEVEL": invalid identifier 


SQL> SELECT EMP_NAME , EMP_SALARY , EMP_GRADE_LEVEL ,
  2         COLL_NAME , COLL_SALARY , COLL_GRADE_LEVEL
  3  FROM
  4  (SELECT E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL
  5  FROM EMPLOYEES E
  6  JOIN JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL)
  7  JOIN
  8  (SELECT C.FIRST_NAME COLL_NAME , C.SALARY COLL_SALARY , CJ.GRADE_LEVEL COLL_GRADE_LEVEL
  9  FROM EMPLOYEES C
 10  JOIN JOB_GRADES CJ ON C.SALARY BETWEEN CJ.LOWEST_SAL AND CJ.HIGHEST_SAL)
 11  ON EMP_GRADE_LEVEL = COLL_GRADE_LEVEL;

EMP_NAME        EMP_SALARY EMP COLL_NAME       COLL_SALARY COL                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- ---------- --- --------------- ----------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                      
Randall               2600 A   Peter                  2500 A                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Randall               2600 A   Randall                2600 A                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Peter                 2500 A   Peter                  2500 A                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Peter                 2500 A   Randall                2600 A                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Curtis                3100 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Curtis                3100 B   Trenna                 3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Curtis                3100 B   Diana                  4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Curtis                3100 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Curtis                3100 B   Kevin                  5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Trenna                3500 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Trenna                3500 B   Trenna                 3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Trenna                3500 B   Diana                  4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Trenna                3500 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Trenna                3500 B   Kevin                  5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Trenna                 3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Diana                  4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Kevin                  5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jennifer              4400 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jennifer              4400 B   Trenna                 3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        

EMP_NAME        EMP_SALARY EMP COLL_NAME       COLL_SALARY COL                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- ---------- --- --------------- ----------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                      
Jennifer              4400 B   Diana                  4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jennifer              4400 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jennifer              4400 B   Kevin                  5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Trenna                 3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Diana                  4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Kevin                  5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Pat                   6000 C   Bruce                  6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Pat                   6000 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Pat                   6000 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Pat                   6000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Pat                   6000 C   Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Pat                   6000 C   Alexander              9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Bruce                  6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Alexander              9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kimerely              7000 C   Bruce                  6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        

EMP_NAME        EMP_SALARY EMP COLL_NAME       COLL_SALARY COL                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- ---------- --- --------------- ----------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                      
Kimerely              7000 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kimerely              7000 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kimerely              7000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kimerely              7000 C   Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kimerely              7000 C   Alexander              9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Bruce                  6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Alexander              9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   Bruce                  6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   Alexander              9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
William               8300 C   Bruce                  6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
William               8300 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
William               8300 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
William               8300 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        

EMP_NAME        EMP_SALARY EMP COLL_NAME       COLL_SALARY COL                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- ---------- --- --------------- ----------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                      
William               8300 C   Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
William               8300 C   Alexander              9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D   Eleni                 10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D   Ellen                 11000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D   Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D   Michael               13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Ellen                11000 D   Eleni                 10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Ellen                11000 D   Ellen                 11000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Ellen                11000 D   Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Ellen                11000 D   Michael               13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Shelley              12000 D   Eleni                 10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Shelley              12000 D   Ellen                 11000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Shelley              12000 D   Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Shelley              12000 D   Michael               13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Michael              13000 D   Eleni                 10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Michael              13000 D   Ellen                 11000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Michael              13000 D   Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Michael              13000 D   Michael               13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Lex                  17000 E   Neena                 17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Lex                  17000 E   Lex                   17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Lex                  17000 E   Steven                24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        

EMP_NAME        EMP_SALARY EMP COLL_NAME       COLL_SALARY COL                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- ---------- --- --------------- ----------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                      
Neena                17000 E   Neena                 17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Neena                17000 E   Lex                   17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Neena                17000 E   Steven                24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Steven               24000 E   Neena                 17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Steven               24000 E   Lex                   17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Steven               24000 E   Steven                24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        

90 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT EMP_NAME , EMP_SALARY , EMP_GRADE_LEVEL ,
  2         COLL_NAME , COLL_SALARY , COLL_GRADE_LEVEL
  3  FROM
  4  (SELECT E.EMPLOYEE_ID EMP_ID , E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL
  5  FROM EMPLOYEES E
  6  JOIN JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL)
  7  JOIN
  8  (SELECT C.EMPLOYEE_ID COLL_ID , C.FIRST_NAME COLL_NAME , C.SALARY COLL_SALARY , CJ.GRADE_LEVEL COLL_GRADE_LEVEL
  9  FROM EMPLOYEES C
 10  JOIN JOB_GRADES CJ ON C.SALARY BETWEEN CJ.LOWEST_SAL AND CJ.HIGHEST_SAL)
 11  ON EMP_GRADE_LEVEL = COLL_GRADE_LEVEL
 12* AND EMP_ID < COLL_ID
SQL> FX
SP2-0042: unknown command "FX" - rest of line ignored.
SQL> 
SQL> 
SQL> 
SQL> SELECT EMP_NAME , EMP_SALARY , EMP_GRADE_LEVEL ,
  2         COLL_NAME , COLL_SALARY , COLL_GRADE_LEVEL
  3  FROM
  4  (SELECT E.EMPLOYEE_ID EMP_ID , E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL
  5  FROM EMPLOYEES E
  6  JOIN JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL)
  7  JOIN
  8  (SELECT C.EMPLOYEE_ID COLL_ID , C.FIRST_NAME COLL_NAME , C.SALARY COLL_SALARY , CJ.GRADE_LEVEL COLL_GRADE_LEVEL
  9  FROM EMPLOYEES C
 10  JOIN JOB_GRADES CJ ON C.SALARY BETWEEN CJ.LOWEST_SAL AND CJ.HIGHEST_SAL)
 11  ON EMP_GRADE_LEVEL = COLL_GRADE_LEVEL
 12  AND EMP_ID < COLL_ID;

EMP_NAME        EMP_SALARY EMP COLL_NAME       COLL_SALARY COL                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- ---------- --- --------------- ----------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                      
Steven               24000 E   Neena                 17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Steven               24000 E   Lex                   17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Neena                17000 E   Lex                   17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Bruce                  6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Kevin                  5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Trenna                 3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Trenna                 3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Trenna                3500 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Trenna                3500 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        

EMP_NAME        EMP_SALARY EMP COLL_NAME       COLL_SALARY COL                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- ---------- --- --------------- ----------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                      
Curtis                3100 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Randall               2600 A   Peter                  2500 A                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D   Ellen                 11000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D   Michael               13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D   Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Ellen                11000 D   Michael               13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Ellen                11000 D   Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kimerely              7000 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kimerely              7000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Michael              13000 D   Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Pat                   6000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        

35 rows selected.

SQL> SELECT EMP_NAME , EMP_SALARY , EMP_GRADE_LEVEL ,
  2         COLL_NAME , COLL_SALARY , COLL_GRADE_LEVEL
  3  FROM
  4  (SELECT E.EMPLOYEE_ID EMP_ID , E.FIRST_NAME EMP_NAME , E.SALARY EMP_SALARY , EJ.GRADE_LEVEL EMP_GRADE_LEVEL
  5  FROM EMPLOYEES E
  6  JOIN JOB_GRADES EJ ON E.SALARY BETWEEN EJ.LOWEST_SAL AND EJ.HIGHEST_SAL)
  7  JOIN
  8  (SELECT C.EMPLOYEE_ID COLL_ID , C.FIRST_NAME COLL_NAME , C.SALARY COLL_SALARY , CJ.GRADE_LEVEL COLL_GRADE_LEVEL
  9  FROM EMPLOYEES C
 10  JOIN JOB_GRADES CJ ON C.SALARY BETWEEN CJ.LOWEST_SAL AND CJ.HIGHEST_SAL)
 11  ON EMP_GRADE_LEVEL = COLL_GRADE_LEVEL
 12  AND EMP_ID < COLL_ID
 13  ORDER BY 3;

EMP_NAME        EMP_SALARY EMP COLL_NAME       COLL_SALARY COL                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- ---------- --- --------------- ----------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                      
Randall               2600 A   Peter                  2500 A                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Kevin                  5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Curtis                3100 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Trenna                3500 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kevin                 5800 B   Trenna                 3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Jennifer               4400 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Diana                 4200 B   Trenna                 3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Trenna                3500 B   Curtis                 3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Pat                   6000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kimerely              7000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Bruce                 6000 C   Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Alexander             9000 C   Bruce                  6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        

EMP_NAME        EMP_SALARY EMP COLL_NAME       COLL_SALARY COL                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- ---------- --- --------------- ----------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                      
Alexander             9000 C   Jonathon               8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   Kimerely               7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Kimerely              7000 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   William                8300 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Jonathon              8600 C   Pat                    6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Ellen                11000 D   Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Ellen                11000 D   Michael               13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D   Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D   Michael               13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Eleni                10500 D   Ellen                 11000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Michael              13000 D   Shelley               12000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Steven               24000 E   Lex                   17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Steven               24000 E   Neena                 17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Neena                17000 E   Lex                   17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                        

35 rows selected.

SQL> SELECT * FROM JOB_GRADES;

GRA LOWEST_SAL HIGHEST_SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
--- ---------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
A         1000        2999                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
B         3000        5999                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
C         6000        9999                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
D        10000       14999                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
E        15000       24999                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
F        25000       40000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          

6 rows selected.

SQL> SELECT E.FIRST_NAME EMP_NAME, E.SALARY EMP_SAL, JGE.GRADE_LEVEL EMP_GRADE,
  2  C.FIRST_NAME COLL_NAME, C.SALARY COLL_SAL, JGC.GRADE_LEVEL COLL_GRADE
  3  FROM JOB_GRADES JGE
  4  JOIN JOB_GRADES JGC ON JGE.GRADE_LEVEL = JGC.GRADE_LEVEL
  5  JOIN EMPLOYEES E ON E.SALARY BETWEEN JGE.LOWEST_SAL AND JGE.HIGHEST_SAL
  6  JOIN EMPLOYEES C ON C.SALARY BETWEEN JGC.LOWEST_SAL AND JGC.HIGHEST_SAL
  7  WHERE E.EMPLOYEE_ID > C.EMPLOYEE_ID ;

EMP_NAME           EMP_SAL EMP COLL_NAME         COLL_SAL COL                                                                                                                                                                                                                                                                                                                                                                                                                                                       
--------------- ---------- --- --------------- ---------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                       
William               8300 C   Pat                   6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
William               8300 C   Kimerely              7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
William               8300 C   Jonathon              8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
William               8300 C   Bruce                 6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
William               8300 C   Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Shelley              12000 D   Michael              13000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Shelley              12000 D   Ellen                11000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Shelley              12000 D   Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Pat                   6000 C   Kimerely              7000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Pat                   6000 C   Jonathon              8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Pat                   6000 C   Bruce                 6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Pat                   6000 C   Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Michael              13000 D   Ellen                11000 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Michael              13000 D   Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Jennifer              4400 B   Curtis                3100 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Jennifer              4400 B   Trenna                3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Jennifer              4400 B   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Jennifer              4400 B   Diana                 4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Kimerely              7000 C   Jonathon              8600 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Kimerely              7000 C   Bruce                 6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Kimerely              7000 C   Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         

EMP_NAME           EMP_SAL EMP COLL_NAME         COLL_SAL COL                                                                                                                                                                                                                                                                                                                                                                                                                                                       
--------------- ---------- --- --------------- ---------- ---                                                                                                                                                                                                                                                                                                                                                                                                                                                       
Jonathon              8600 C   Bruce                 6000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Jonathon              8600 C   Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Ellen                11000 D   Eleni                10500 D                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Peter                 2500 A   Randall               2600 A                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Curtis                3100 B   Trenna                3500 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Curtis                3100 B   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Curtis                3100 B   Diana                 4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Trenna                3500 B   Kevin                 5800 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Trenna                3500 B   Diana                 4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Kevin                 5800 B   Diana                 4200 B                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Bruce                 6000 C   Alexander             9000 C                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Lex                  17000 E   Neena                17000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Lex                  17000 E   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         
Neena                17000 E   Steven               24000 E                                                                                                                                                                                                                                                                                                                                                                                                                                                         

35 rows selected.

SQL> SPOOL OFF
